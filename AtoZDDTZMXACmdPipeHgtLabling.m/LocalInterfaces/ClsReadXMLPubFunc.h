//===================================================================
// COPYRIGHT ATOZ 2020/11/23
//===================================================================
// ClsReadXMLPubFunc.cpp
// Header definition of class ClsReadXMLPubFunc
//===================================================================
//
// Usage notes:
//
//===================================================================
//  2020/11/23 Creation: Code generated by the 3DS wizard
//===================================================================

#ifndef ClsReadXMLPubFunc_H
#define ClsReadXMLPubFunc_H

//XMLParserItf includes
#include "CATIXMLDOMDocumentBuilder.h"
#include "CATIDOMImplementation.h"
#include "CATIDOMDocument.h"
#include "CATIDOMElement.h"
#include "CATIDOMDocumentType.h"
#include "CATIDOMText.h"
#include "CATIXMLSAX2Factory.h"
#include "CATISAXEntityResolver.h"
#include "CATIDOMNodeList.h"

//SystemTS includes
#include "CATToken.h"

#include "iostream.h"
#include "fstream.h"
#include <vector>
using namespace std;
//-----------------------------------------------------------------------

class ClsReadXMLPubFunc
{
public:
// Standard constructors and destructors
// -------------------------------------
ClsReadXMLPubFunc ();
virtual ~ClsReadXMLPubFunc ();

//get dllPath
static HRESULT Get_ComputeDataExePath(CATUnicodeString &strExePath);

//open xml 
static HRESULT OpenXMLByfullName(CATUnicodeString istrXMLPath,
	                            CATIDOMDocument_var &ospDOMDocument);

//获取配置文件Drawing ID号、版本和高程名称
static HRESULT GetDrawingTemplateInfo(const CATUnicodeString &istrXmlPath,
	                                  CATUnicodeString &ostrDrawingNum,
	                                  CATUnicodeString &ostrDrwVersion,
	                                  CATUnicodeString &ostrGaoChengName);

//获取节点文本信息
static HRESULT GetNodeText(const CATIDOMElement_var &ispDomElem,
	                       CATUnicodeString &ostrNodeText);
private:
// Copy constructor and equal operator
// -----------------------------------
ClsReadXMLPubFunc (ClsReadXMLPubFunc &);
ClsReadXMLPubFunc& operator=(ClsReadXMLPubFunc&);

};

//-----------------------------------------------------------------------

#endif
